{% extends "requests/agent/base_agent.html" %}
{% block title %}Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­Ø¬Ø² ğŸ“‹{% endblock %}

{% block content %}
<div class="bg-white shadow-lg p-6 rounded-xl">

  <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
  <h1 class="text-2xl font-bold text-green-700 mb-6 flex items-center gap-2">
    <i class="fas fa-tasks"></i> Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­Ø¬Ø²
  </h1>

  <!-- ÙÙ„ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ -->
  <form method="get" class="mb-6 flex flex-wrap gap-4 items-center">
    <label for="purpose" class="text-sm text-gray-700 font-medium">Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨:</label>
    <select name="purpose" id="purpose" class="px-4 py-2 border border-gray-300 rounded-md focus:ring focus:ring-green-200">
      <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
      <option value="buy" {% if request.GET.purpose == "buy" %}selected{% endif %}>Ø´Ø±Ø§Ø¡</option>
      <option value="sell" {% if request.GET.purpose == "sell" %}selected{% endif %}>Ø¨ÙŠØ¹</option>
      <option value="rent_out" {% if request.GET.purpose == "rent_out" %}selected{% endif %}>ØªØ£Ø¬ÙŠØ±</option>
      <option value="rent" {% if request.GET.purpose == "rent" %}selected{% endif %}>Ø§Ø³ØªØ¦Ø¬Ø§Ø±</option>
    </select>

    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md">
      ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
    </button>
  </form>

  <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
  {% if requests %}
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
      {% for req in requests %}
        <div class="bg-green-50 border border-green-200 rounded-2xl p-5 shadow-md hover:shadow-lg transition duration-200">
          
          <!-- Ø±Ø£Ø³ Ø§Ù„ÙƒØ±Øª -->
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-extrabold text-green-800">ğŸ“„ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: {{ req.id }}</h2>
            <span class="text-xs bg-green-100 text-green-700 px-3 py-1 rounded-full border">
              {{ req.get_purpose_display }}
            </span>
          </div>

          <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ -->
          <div class="text-sm text-gray-800 space-y-1 leading-relaxed">
            <p><strong>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</strong> {{ req.full_name }}</p>
            <p><strong>ğŸ  Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±:</strong> {{ req.get_property_type_display }}</p>
            <p><strong>ğŸ“ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> {{ req.city }} - {{ req.district }}</p>
            <p><strong>ğŸ“ Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong> {{ req.area }} Ù…Â²</p>
            <p><strong>ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©:</strong> {{ req.budget|floatformat:0 }} Ø±ÙŠØ§Ù„</p>
            <p><strong>ğŸ“ Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„:</strong> {{ req.phone_number }}</p>

            {% if req.message %}
              <div class="mt-3">
                <p class="font-semibold text-green-700">ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©:</p>
                <div class="bg-white border border-green-100 p-3 rounded text-gray-700 whitespace-pre-line text-sm">
                  {{ req.message }}
                </div>
              </div>
            {% endif %}
          </div>

          <!-- Ø²Ø± Ø§Ù„Ø­Ø¬Ø² -->
          <div class="mt-6 text-end">
            <a href="{% url 'requests:confirm_reserve' req.id %}"
               class="bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg text-sm shadow transition">
              âœ… Ø§Ø­Ø¬Ø² Ø§Ù„Ø·Ù„Ø¨
            </a>
          </div>

        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-500 text-center mt-12 text-lg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­Ø¬Ø² ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ.</p>
  {% endif %}

</div>
{% endblock %}
